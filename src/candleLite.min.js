'use strict';var _createClass=function(){function g(j,k){for(var o,m=0;m<k.length;m++)o=k[m],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(j,o.key,o)}return function(j,k,m){return k&&g(j.prototype,k),m&&g(j,m),j}}(),_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&'function'==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?'symbol':typeof g};function _classCallCheck(g,j){if(!(g instanceof j))throw new TypeError('Cannot call a class as a function')}var Chart=function(){var g={gray:{backgroundColor:'#f5f5f5',textColor:'#5d5d5d',axisColor:'#999',splitAxisColor:'rgba(0,0,0,0.05)',candle:{incrementItemColor:'#14b143',decrementItemColor:'#ef232a',minBodyWidth:7},line:{itemColor:'#000000'}},dark:{backgroundColor:'#151515',textColor:'#aaa',axisColor:'#999',splitAxisColor:'rgba(255,255,255,0.1)',candle:{incrementItemColor:'#14b143',decrementItemColor:'#ef232a',minBodyWidth:7},line:{itemColor:'#999'}}},j={candle:function candle(_ref,_ref2){var A=_ref.ctx,B=_ref.itemWidth,C=_ref.transform,D=_ref.style,E=_ref2.open,F=_ref2.close,G=_ref2.high,H=_ref2.low,I=C(Math.max(E,F)),J=C(Math.min(E,F))-I,K=C(G),L=C(H);return A.strokeStyle=F>E?D.incrementItemColor:D.decrementItemColor,A.fillStyle=F>E?D.incrementItemColor:D.decrementItemColor,B<=D.minBodyWidth?(A.beginPath(),A.moveTo(q(0.5*B),q(K)),A.lineTo(q(0.5*B),q(L)),A.closePath(),void A.stroke()):void(A.beginPath(),A.moveTo(q(0.5*B),q(K)),A.lineTo(q(0.5*B),q(I)),A.closePath(),A.stroke(),A.beginPath(),A.moveTo(q(0.5*B),q(I+J)),A.lineTo(q(0.5*B),q(L)),A.closePath(),A.stroke(),A.fillRect(2,q(I),q(B-4),q(J)),A.strokeRect(2,q(I),q(B-4),q(J)))},line:function line(_ref3,E){var A=_ref3.ctx,B=_ref3.itemWidth,C=_ref3.transform,D=_ref3.style;if(null!==E){var F=C(E);A.fillStyle=D.itemColor,A.strokeStyle=D.itemColor,A.lineTo(q(0.5*B),F)}}},k={candle:function candle(A,B){return'<div>Open: '+B.open+'</div><div>Close: '+B.close+'</div><div>Low: '+B.low+'</div><div>High: '+B.high+'</div><br/>'},line:function line(A,B,C){return'<div style=\'color:'+C+'\'>'+A+': '+B+'</div>'}},m={candle:function candle(A){return A.low},line:function line(A){return A}},o={candle:function candle(A){return A.high},line:function line(A){return A}},p=function(A,B,C,D,E){return(A-B)/(C-B)*(E-D)+D},q=Math.floor,r=function(A,B){('object'!==('undefined'==typeof A?'undefined':_typeof(A))||null===A)&&(A={});for(var F,C=Object.keys(B),D=0,E=C.length;D<E;D++)F=C[D],void 0===A[F]&&(A[F]=B[F]);return A},u=function(A,B){return B.replace(/(yyyy|yy|MM|dd|hh|mm|ss)/gi,function(C){return'yyyy'===C?A.getFullYear():'yy'===C?w(A.getFullYear()%1e3,2):'MM'===C?w(A.getMonth()+1,2):'dd'===C?w(A.getDate(),2):'HH'===C?w(A.getHours(),2):'hh'===C?w((h=A.getHours()%12)?h:12,2):'mm'===C?w(A.getMinutes(),2):'ss'===C?w(A.getSeconds(),2):C})},w=function(A,B){if('number'==typeof A&&(A=A.toString()),'string'==typeof A){for(var C='',D=0;D++<B-A.length;)C+='0';return C+A}},z=function(){function A(B){var la=this;_classCallCheck(this,A);var G=document.getElementById(B);if(null!==G){var H;G.style.position='relative';var I=document.createElement('div');I.classList.add('candle-lite-tooltip'),G.appendChild(I);var Q,R,V,J=[],K=function(){var pa=document.createElement('canvas'),qa=pa.getContext('2d');return pa.style.position='absolute',pa.style.top=0,pa.style.left=0,pa.width=G.clientWidth,pa.height=G.clientHeight,G.appendChild(pa),qa.translate(0.5,0.5),J.push(pa),{canvas:pa,context:qa}},L={type:'candle',grid:{top:0,right:100,bottom:30,left:0},padding:{top:50,right:0,bottom:50,left:0},style:{yLabelAlign:'right',yLabelWidth:100,xLabelAlign:'bottom',xLabelHeight:30,axisColor:'',splitAxisColor:'',textColor:''},dateFormatter:'MM-dd HH:mm'},M={},N=[],O=[],C=L.grid,D=L.padding,E=L.style,F=L.dateFormatter,P=E,S=K().context,T=K().context,U=K().context,Y=function(pa,qa){for(var ua,ra=Object.keys(M),sa=[],ta=0;ta<ra.length;ta++)ua=ra[ta],sa['function'==typeof qa?qa(ua):ta]=pa(M[ua],ua);return sa},Z=function(pa,qa){N[0]=Math.min(pa,qa),N[1]=Math.max(pa,qa),fa(),ha()},ea=function(){return{tWidth:G.clientWidth-C.right-C.left,tHeight:G.clientHeight-C.bottom-C.top}},fa=function(){for(var pa=Y(function(ta){for(var ua=ta.data,va=ta.type,wa=m[va],xa=o[va],ya=Infinity,za=-Infinity,Aa=N[0],Ba=N[1];Aa<Ba;Aa++)if(null!==ua[Aa]){var Ca=wa(ua[Aa]),Da=xa(ua[Aa]);ya>Ca&&(ya=Ca),za<Da&&(za=Da)}return{min:ya,max:za}}),qa=Infinity,ra=-Infinity,sa=0;sa<pa.length;sa++)pa[sa].min<qa&&(qa=pa[sa].min),pa[sa].max>ra&&(ra=pa[sa].max);Q=qa,R=ra},ga=function(pa){var qa=P.xLabelHeight,ra=P.xLabelAlign,sa=P.yLabelWidth,ta=P.yLabelAlign,ua=pa.data,va=pa.type,wa=pa.context,xa=pa.canvas,ya=pa.style,Ba=G.clientWidth,Ca=G.clientHeight;(void 0===N[0]||void 0===N[1])&&Z(0,O.length);var Da=j[va],_getTransformSize=ea(),za=_getTransformSize.tWidth,Aa=_getTransformSize.tHeight,Ea=za/(N[1]-N[0]);wa.save(),T.save(),S.save(),wa.clearRect(-10,-10,Ba+10,Ca+10),T.clearRect(-10,-10,Ba+10,Ca+10),S.clearRect(-10,-10,Ba+10,Ca+10),wa.translate(C.left,Aa+C.top),T.translate(C.left,0),S.translate(0,Aa+C.top),T.textBaseline='middle',T.textAlign='left',T.font='12px \'Apple SD Gothic Neo\',arial,sans-serif';var Fa=q('top'===ra?qa:Ca-qa),Ga='top'===ra?qa/2:Ca-qa/2;T.strokeStyle=P.axisColor,T.beginPath(),T.moveTo(0,Fa),T.lineTo(za,Fa),T.closePath(),T.stroke(),wa.beginPath();for(var Ha=N[0],Ia=N[1],Ja=q((N[1]-N[0])/5);Ha<Ia;Ha++){if(Da({ctx:wa,itemWidth:Ea,transform:function transform(Ua){return-p(Ua,Q,R,D.top,Aa-D.bottom)},style:ya},ua[Ha]),-1==N[0]-Ia||0==(Ia-Ha)%Ja){var Ka=q(0.5*Ea);T.strokeStyle=P.axisColor,T.beginPath(),T.moveTo(Ka,Fa),T.lineTo(Ka,Fa+5),T.closePath(),T.stroke(),T.strokeStyle=P.splitAxisColor,T.beginPath(),T.moveTo(Ka,0),T.lineTo(Ka,Fa),T.closePath(),T.stroke(),T.fillStyle=P.textColor,T.fillText(u(O[Ha],F),q(Ka),q(Ga))}wa.translate(Ea,0),T.translate(Ea,0)}wa.stroke(),wa.closePath(),S.textBaseline='middle',S.textAlign='left'===ta?'right':'left',S.font='12px \'Apple SD Gothic Neo\',arial,sans-serif';var La=q('left'===ta?sa:Ba-sa);S.beginPath(),S.strokeStyle=P.axisColor,S.moveTo(La,0),S.lineTo(La,-Aa),S.closePath(),S.stroke();for(var Na=(R-Q)/10,Oa=10,Pa=1;Pa+Oa<Na;)Pa*=Oa;var Qa=q(Q-Q%Pa);S.fillStyle=P.textColor;for(var Sa,Ra=0;Ra<Ma&&(Sa=Qa+Pa*Ra,!(Sa>R));Ra++)if(!(Sa<Q)){var Ta=-p(Sa,Q,R,0,Aa);S.fillText(Sa.toString(),La+5,Ta),S.strokeStyle=P.splitAxisColor,S.beginPath(),S.moveTo(C.left,Ta),S.lineTo(La-1,Ta),S.closePath(),S.stroke()}S.restore(),T.restore(),wa.restore()},ha=function(){return Y(function(pa){return ga(pa)})};G.addEventListener('mousewheel',function(pa){var qa=-5*(pa.deltaY/100),ra=[N[0]+qa,N[1]];0>ra[0]&&(ra[0]=0,ra[1]-=qa),ra[1]>O.length&&(ra[1]=O.length),ra[0]>=ra[1]&&(ra[0]=ra[1]-1),Z(ra[0],ra[1]),ka({x:pa.layerX,y:pa.layerY})});var ia=!1,ja=null;G.addEventListener('mousedown',function(pa){ia=!0,ja=pa.clientX}),window.addEventListener('mouseup',function(){!0==ia&&(ia=!1,ja=null)}),window.addEventListener('mousemove',function(pa){var qa=ja-pa.clientX;if(!0==ia&&null!==ja&&10<=Math.abs(qa)){pa.preventDefault();var ra=0>qa?-1:1,sa=5*ra,ta=[N[0]+sa,N[1]+sa];if(0>ta[0]||ta[1]>O.length)return;Z(ta[0],ta[1]),ja=pa.clientX}}),G.addEventListener('mousemove',function(pa){ka({x:pa.layerX,y:pa.layerY})}),G.addEventListener('mouseout',function(){U.clearRect(-10,-10,G.clientWidth+10,G.clientHeight+10)});var ka=function(_ref6){var pa=_ref6.x,qa=_ref6.y,_getTransformSize2=ea(),ra=_getTransformSize2.tWidth,sa=_getTransformSize2.tHeight,ta=ra/(N[1]-N[0]),ua=Math.floor(pa/ta),va=N[0]+ua;if(0>va||va>=N[1])return void U.clearRect(-10,-10,G.clientWidth+10,G.clientHeight+10);U.save(),U.clearRect(-10,-10,G.clientWidth+10,G.clientHeight+10),U.fillStyle='rgba(0, 175, 255, 0.1)',U.strokeStyle='rgba(0, 175, 255, 0.2)',U.fillRect(ua*ta,C.top,ta,sa),U.strokeRect(ua*ta,C.top,ta,sa),U.restore();var wa=Y(function(xa){return'object'===xa.data[va]?r(null,xa.data[va]):xa.data[va]},function(xa){return xa});la.onSelect(wa,ma(wa))},ma=function(pa){return function(qa,ra){void 0===ra&&(ra={});for(var sa=M[qa],ta=Object.keys(pa),va=0,wa=ta.length;va<wa;va++){var xa=ta[va],ya=M[xa];k[ya.type](ra[xa]||xa,pa[xa],ya.style.itemColor||'')}I.innerHTML='<div class=\'candle-lite-tooltip-colorpick\' style=\'background-color:'+(pa[qa].close>pa[qa].open?sa.style.incrementItemColor:sa.style.decrementItemColor)+'\'></div>'+ua}},na=function(pa){H=g[pa],G.style.backgroundColor=H.backgroundColor,V={},V.candle=r(null,H.candle),V.line=r(null,H.line),Y(function(qa){return qa.style=r(V[qa.type],qa.style)}),E.axisColor=H.axisColor,E.splitAxisColor=H.splitAxisColor,E.textColor=H.textColor,ha()};na('gray');this.addLayer=function W(pa,_ref4){var qa=_ref4.type,ra=_ref4.data,sa=_ref4.style;if(void 0===M[pa]){var ta=K();ta.type=qa||L.layer.type,ta.data=ra?ra:[],ta.style=r(sa,V[ta.type]),M[pa]=ta,fa()}},this.setLayer=function X(pa,_ref5){var qa=_ref5.type,ra=_ref5.data,sa=_ref5.style,ta=M[pa],ua=ta.style;void 0!==qa&&qa!==ta.type&&(ta.style={},ua=V[qa]),ta.type=qa||ta.type,ta.data=ra?ra:ta.data,ta.style=r(sa,ua),fa(),ga(ta)},this.setViewport=Z,this.getViewport=function $(){return[N[0],N[1]]},this.setTimeline=function _(pa){O=[];for(var qa=0,ra=pa.length;qa<ra;qa++)O.push(new Date(pa[qa]))},this.setGrid=function ba(pa){C=r(pa,C),ha()},this.setPadding=function ca(){D=r(pGrid,D),ha()},this.render=function(){return ha()},this.setTheme=na,this.resize=function oa(){J.map(function(pa){pa.width=G.clientWidth,pa.height=G.clientHeight}),ha()},this.onSelect=function(){},this.setDateFormatter=F}}return _createClass(A,[{key:'addTheme',value:function addTheme(B,C){_addTheme(B,C)}}]),A}();return z.addTheme=function(A,B){return g[A]=B},z.calculateMA=function(A,B){for(var C=[],D=[],E=0,F=0,G=B.length;F<G;F++)C[F]=null,D.push(B[F]),E+=B[F],D.length===A&&(C[F]=E/A,E-=D.shift());return C},z}();
