"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Chart=function(){var t=function(t){return t},e={globalStyle:{backgroundColor:"rgb(245, 250, 254)",fontFamily:"맑은고딕",labelColor:"#5d5d5d",yLabelShow:!0,yLabelAlign:"right",yLabelWidth:100,yAxisShow:!0,yAxisColor:"#999",xLabelShow:!0,xLabelAlign:"bottom",xLabelHeight:30,xAxisShow:!0,xAxisColor:"#999",xSplitAxisColor:"rgb(210, 215, 219)",xSplitAxisDotted:!1,ySplitAxisColor:"rgb(210, 215, 219)",ySplitAxisDotted:[1,2],tooltipTextColor:"#333",tooltipBackgroundColor:"transparent",tooltipXAlign:"left",tooltipYAlign:"top",tooltipMinWidth:100,tooltipFontSize:14,tooltipXMargin:5,tooltipYMargin:5,tooltipXPadding:20,tooltipYPadding:5,tooltipCandleThick:5,tooltipLetterSpace:10,focusXAxisColor:"rgba(105, 100, 104, 0.1)",focusXBackgroundColor:"#555",focusXLabelColor:"#fff",focusXAxisExtend:!0,focusYAxisColor:"#888",focusYBackgroundColor:"#555",focusYLabelColor:"#fff",minSpan:8,renderLastIndex:!0,lastIndexYLabelColor:"#333"},layerType:"candle",layerStyle:{candle:{incrementItemColor:"rgb(252,4,4)",decrementItemColor:"rgb(0,168,0)",decrementItemFill:!0,incrementItemFill:!0,renderMinMaxInViewport:!1},line:{itemColor:"#000000",horizon:null,renderMinMaxInViewport:!1},stick:{itemColor:"#000000",itemFill:!0,linear:!1,baseLine:null,renderMinMaxInViewport:!1}},grid:{top:0,right:0,bottom:0,left:0},padding:{top:30,right:0,bottom:30,left:0},dateFormatter:"MM-dd HH:mm"},o={white:{globalStyle:{},layerStyle:{candle:{},line:{}}},dark:{globalStyle:{backgroundColor:"#151515",labelColor:"#aaa",xSplitAxisColor:"#333",ySplitAxisColor:"#333",tooltipTextColor:"#fff",focusXAxisColor:"rgba(0, 175, 255, 0.2)",focusXBackgroundColor:"rgb(10,98,138)",focusYBackgroundColor:"#333",tooltipBackgroundColor:"rgba(0,0,0,0.25)",lastIndexYLabelColor:"#fff"},layerStyle:{candle:{incrementItemColor:"#14b143",decrementItemColor:"#ef232a"},line:{itemColor:"#999"},stick:{itemColor:"#999"}}}},n={candle:function(e){var o=e.title,n=e.data,r=e.formatter,i=void 0===r?t:r;return null===n||void 0===n?null:[(o.open||"Open")+" "+i(n.open),(o.close||"Close")+" "+i(n.close),(o.low||"Low")+" "+i(n.low),(o.high||"High")+" "+i(n.high)]},line:function(e){var o=e.title,n=e.data,r=e.formatter,i=void 0===r?t:r;return null===n||void 0===n?null:o+" "+i(n)},stick:function(e){var o=e.title,n=e.data,r=e.formatter,i=void 0===r?t:r;return null===n||void 0===n?null:o+" "+i(n)}},r={candle:function(t){return t.low},line:function(t){return t},stick:function(t){return t}},i={candle:function(t){return t.high},line:function(t){return t},stick:function(t){return t}},l=function(t,e,o,n,r){return(t-e)/(o-e)*(r-n)+n},a=Math.floor,s=function(t,e){("object"!==("undefined"==typeof t?"undefined":_typeof(t))||null===t)&&(t={});for(var o in e)void 0===t[o]&&(t[o]=e[o]);return t},u=function(t,e){var o=void 0;return e.replace(/(yyyy|yy|MM|dd|hh|mm|ss)/gi,function(e){switch(e){case"yyyy":return t.getFullYear();case"yy":return c(t.getFullYear()%1e3,2);case"MM":return c(t.getMonth()+1,2);case"dd":return c(t.getDate(),2);case"HH":return c(t.getHours(),2);case"hh":return c((o=t.getHours()%12)?o:12,2);case"mm":return c(t.getMinutes(),2);case"ss":return c(t.getSeconds(),2);default:return e}})},c=function(t,e){if("number"==typeof t&&(t=t.toString()),"string"==typeof t){for(var o="",n=0;n++<e-t.length;)o+="0";return o+t}},f=[],h={},d=function(t,e,o){h[t]||(h[t]=[]),h[t][e]=o,"$On"!==e&&h[t].$On&&h[t].$On(e)},g=function(t,e){return h[t][e]},m=function p(t){var c=this;_classCallCheck(this,p);var m=document.getElementById(t);if(null!==m){for(var v=void 0;-1!==f.indexOf(v=Math.random()+Math.random()+Math.random()););var y=void 0,x={};m.style.position="relative";var b=[],C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=document.createElement("canvas"),o=e.getContext("2d");return e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=t,e.width=m.clientWidth,e.height=m.clientHeight,m.appendChild(e),o.translate(.5,.5),b.push(e),{canvas:e,context:o}},S={},A=[],T=[],w=[],k=s(null,e.grid),L=s(null,e.padding),P=s(null,e.globalStyle),M=e.dateFormatter,I=void 0,Y=void 0,H=void 0,X=C().context,F=C().context,W=C().context,$=C(1).context,B=C(2).context,R=function(t,o){var n=o.type,r=o.data,i=o.show,l=o.style;if(void 0===S[t]){var a=C();a.show=void 0!==i?i:!0,a.type=n||e.layerType,a.data=r||[],a.style=s(l,x[a.type]),S[t]=a,it()}},V=function(t,e){var o=e.type,n=e.show,r=e.data,i=e.style,l=S[t];l.show=void 0!==n?n:l.show;var a=void 0!==o&&o!==l.type?x[o]:l.style;l.type=o||l.type,l.data=r||l.data,l.style=s(i,a),it()},D=function(t,e){var o=[];for(var n in S){var r=t(S[n],n);e?o[e(n)]=r:o.push(r)}return o},_=function(t,e){if(!(0>t||0>e||A[0]===t&&A[1]===e)){var o=Math.max(t,e),n=Math.min(t,e);A[0]=n,A[1]=o,it()}},E=function(t,e){if(!(0>t||0>e||A[0]===t&&A[1]===e)){var o=Math.max(t,e),n=Math.min(t,e);if(Mt()!==!0){var r=h[c.$rootConnect].minSpan();return r>o-n&&(n=o-r),void h[c.$rootConnect].dispatchSetViewport(n,o)}o-n<P.minSpan&&(n=o-P.minSpan),h[v].dispatchSetViewport(n,o),_(n,o)}},z=function(){return[A[0],A[1]]},N=function(t){for(var e=0,o=t.length;o>e;e++)"string"==typeof t[e]&&(t[e]=new Date(t[e]));w=T=t,h[v]._setTimeline(),Mt()===!0&&h[v].dispatchSetTimeline()},O=function(t){M=t,Z()},j=function(t){L=s(t,L);for(var e in S){var o=S[e];rt(o)}},U=function(t){P=s(t,P),J(),At(),it()},q=a,G=function(t){return q=t},J=function(){var t=P.xLabelShow===!1?0:1,e=P.yLabelShow===!1?0:1;k.top="top"===P.xLabelAlign?P.xLabelHeight*t:0,k.bottom="bottom"===P.xLabelAlign?P.xLabelHeight*t:0,k.left="left"===P.yLabelAlign?P.yLabelWidth*e:0,k.right="right"===P.yLabelAlign?P.yLabelWidth*e:0},K=function(){return{tWidth:m.clientWidth-k.right-k.left,tHeight:m.clientHeight-k.bottom-k.top}},Q=function(){for(var t=D(function(t){var e=t.data,o=t.type,n=t.show,l=t.style;if(n===!1)return{min:1/0,max:-(1/0)};var a=r[o],s=i[o],u=1/0,c=-(1/0);if("line"===o&&l.horizon===!0)return{min:e[0],max:e[0]};for(var f=A[0],h=A[1];h>f;f++)if(null!==e[f]&&void 0!==e[f]){var d=a(e[f]),g=s(e[f]);u>d&&(u=d),g>c&&(c=g)}return t.minInViewport=u,t.maxInViewport=c,{min:u,max:c}}),e=1/0,o=-(1/0),n=0;n<t.length;n++)t[n].min<e&&(e=t[n].min),t[n].max>o&&(o=t[n].max);I=e,Y=o},Z=function(){var t=P,e=t.xLabelHeight,o=t.xLabelAlign,n=t.xLabelShow,r=t.xAxisShow;if(0!==w.length){var i=m.clientWidth,l=m.clientHeight,s=K(),c=s.tWidth,f=s.tHeight,h=c/(A[1]-A[0]);F.save(),F.clearRect(-10,-10,i+10,l+10),F.translate(k.left,0),F.textBaseline="middle",F.textAlign="left"===P.yLabelAlign?"right":"left",F.font="12px "+P.fontFamily;var d=f,g="top"===o?e/2:l-e/2,p="bottom"===o?d:k.top;n!==!1&&(F.strokeStyle=P.xAxisColor,F.beginPath(),F.moveTo(0,p),F.lineTo(c,p),F.closePath(),F.stroke()),F.fillStyle=P.labelColor;for(var v=A[0],y=A[1],x=a((A[1]-A[0])/5);y>v;v++){if(A[0]-y===-1||(y-v)%x===0){var b=a(.5*h);r!==!1&&(Array.isArray(P.xSplitAxisDotted)&&F.setLineDash(P.xSplitAxisDotted),F.strokeStyle=P.xSplitAxisColor,F.beginPath(),F.moveTo(b,k.top),F.lineTo(b,d+k.top),F.closePath(),F.stroke()),n!==!1&&(F.strokeStyle=P.xAxisColor,F.beginPath(),F.moveTo(b,p+("bottom"===o?5:-5)),F.lineTo(b,p),F.closePath(),F.stroke(),F.fillText(u(w[v],M),a(b),a(g)))}F.translate(h,0)}F.restore()}},tt=function(){var t=P,e=t.yLabelWidth,o=t.yLabelAlign,n=t.yLabelShow,r=t.yAxisShow,i=m.clientWidth,s=m.clientHeight,u=K(),c=u.tWidth,f=u.tHeight;X.save(),X.clearRect(-10,-10,i+10,s+10),X.translate(0,-1),X.textBaseline="middle",X.textAlign="left"===o?"right":"left",X.font="12px "+P.fontFamily;var h=a("left"===o?e:i-e);X.strokeStyle=P.yAxisColor,X.fillStyle=P.labelColor,n!==!1&&(X.beginPath(),X.moveTo(h,k.top),X.lineTo(h,k.top+f),X.closePath(),X.stroke());for(var d=2,g=(Y-I)/d,p=1;g>10*p;)p*=10;g-=g%p,g=a(g);for(var v=a(I-I%g),y=-10;d+10>=y;y++){var x=v+g*y,b=l(x,Y,I,k.top+L.top,k.top+f-L.bottom);if(!(b>k.top+f)){if(b<k.top)break;n!==!1&&(X.fillText(q(x),h+("right"===o?10:-10),b),X.strokeStyle=P.labelColor,X.beginPath(),X.moveTo(h,b),X.lineTo(h+("right"===o?5:-5),b),X.closePath(),X.stroke()),r!==!1&&(X.save(),Array.isArray(P.ySplitAxisDotted)&&X.setLineDash(P.ySplitAxisDotted),X.strokeStyle=P.ySplitAxisColor,X.beginPath(),X.moveTo(k.left,b),X.lineTo(c+k.left-1,b),X.closePath(),X.stroke(),X.restore())}}X.restore()},et={candle:function(t){return function(e){return l(e,Y,I,k.top+L.top,k.top+t-L.bottom)}},line:function(t){return function(e){return l(e,Y,I,k.top+L.top,k.top+t-L.bottom)}},stick:function(t){return function(e){return l(e,Y,I,k.top+L.top,k.top+t-L.bottom)}}},ot=function(t,e,o,n,l,s,u,c,f){var h=i[e](f),d=r[e](f),g=n(h),m=n(d);t.strokeStyle=t.fillStyle=P.labelColor,t.textBaseline="middle",t.font="13px "+P.fontFamily;var p=a(.5*o),v=q(h),y=q(d),x=-1,b=(c-A[0])*o+x*Math.max(t.measureText(v).width,t.measureText(y).width)+.5*o+10*x;(b>u||0>b)&&(x*=-1),t.textAlign=1===x?"left":"right",s&&(t.beginPath(),t.moveTo(p,g-5),t.lineTo(p,g-10),t.moveTo(p,g-10),t.lineTo(p+5*x,g-10),t.stroke(),t.closePath(),t.fillText(v,p+10*x,g-10)),l&&(t.beginPath(),t.moveTo(p,m+5),t.lineTo(p,m+10),t.moveTo(p,m+10),t.lineTo(p+5*x,m+10),t.stroke(),t.closePath(),t.fillText(y,p+10*x,m+10))},nt={candle:function(t,e,o,n,r){var i=e.incrementItemColor,l=e.decrementItemColor,s=e.incrementItemFill,u=e.decrementItemFill,c=n.open,f=n.close,h=n.high,d=n.low,g=r(Math.max(c,f)),m=r(Math.min(c,f))-g,p=r(h),v=r(d);if(t.strokeStyle=f>c?i:l,t.fillStyle=f>c?i:l,6>=o){t.beginPath(),t.moveTo(a(.5*o),a(p)),t.lineTo(a(.5*o),a(v)),t.closePath(),t.stroke();var y=a(f>c?g+m:g);t.beginPath(),t.moveTo(a(.5*o),y),t.lineTo(1,y),t.closePath(),t.stroke();var x=a(f>c?g:g+m);return t.beginPath(),t.moveTo(a(.5*o),x),t.lineTo(o-1,x),t.closePath(),void t.stroke()}t.beginPath(),t.moveTo(a(.5*o),a(p)),t.lineTo(a(.5*o),a(g)),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(a(.5*o),a(g+m)),t.lineTo(a(.5*o),a(v)),t.closePath(),t.stroke(),(f>c&&s!==!1||c>=f&&u!==!1)&&t.fillRect(2,a(g),a(o-4),a(m)),t.strokeRect(2,a(g),a(o-4),a(m))},line:function(t,e,o,n,r){var i=e.itemColor,l=r(n);t.fillStyle=i,t.strokeStyle=i,t.lineTo(a(.5*o),l)},stick:function(t,e,o,n,r,i,l){var s=e.baseLine,u=e.linear,c=I,f=r(n),h=1;"number"==typeof s&&(c=s),t.strokeStyle=i,t.fillStyle=i,a(o)<=3||u===!0?(t.beginPath(),t.moveTo(a(.5*o),a(f)),t.lineTo(a(.5*o),a(r(c))),t.closePath(),t.stroke()):(l!==!1&&t.fillRect(a(h),a(f),a(o-2*h),a(r(c)-f)),t.strokeRect(a(h),a(f),a(o-2*h),a(r(c)-f)))}},rt=function(t){var e=t.data,o=t.type,n=t.context,l=t.style,s=t.show,u=t.minInViewport,c=t.maxInViewport,f=m.clientWidth,h=m.clientHeight;if(0!==w.length){(isNaN(A[0])===!0||isNaN(A[1])===!0||void 0===A[0]||void 0===A[1])&&E(0,w.length);var d=nt[o],g=K(),p=g.tWidth,v=g.tHeight,y=p/(A[1]-A[0]);if(n.save(),n.clearRect(-10,-10,f+10,h+10),s!==!1){n.translate(k.left,0);var x=et[o](v);if(n.beginPath(),"line"===t.type&&l.horizon===!0){var b=x(e[0]);n.strokeStyle=l.itemColor,n.moveTo(y/2,b),n.lineTo(p-y/2,b),n.stroke(),n.closePath()}else{var C=A[0],S=A[1];for(a((A[1]-A[0])/5);S>C;C++){if(null!==e[C]&&void 0!==e[C]){var T="function"==typeof l.itemColor?l.itemColor(C):l.itemColor,L="function"==typeof l.itemFill?l.itemFill(C):l.itemFill;d(n,l,y,e[C],x,T,L)}n.translate(y,0)}if(n.stroke(),n.closePath(),l.renderMinMaxInViewport===!0)for(var P=0,M=0,I=A[1]-1;I>=A[0]&&(n.translate(-y,0),!(P>0&&M>0));I--)if(null!==e[I]&&void 0!==e[I]){var Y=i[o](e[I])===c,H=r[o](e[I])===u;if(Y===!0&&P++>0)continue;if(H===!0&&M++>0)continue;if(H);else if(!Y)continue;ot(n,o,y,x,H,Y,p,I,e[I])}}n.restore()}}},it=function(){Q();for(var t in S){var e=S[t];rt(e)}Z(),tt(),bt(),at()},lt=function(t){Ct(t)},at=function(){H&&P.renderLastIndex!==!1&&gt({ctx:W,index:A[1]-1,realPrice:S[H].data[A[1]-1].close,focusYLabelColor:P.lastIndexYLabelColor,focusYAxisColor:"rgba(0,0,0,0)",focusYBackgroundColor:S[H].data[A[1]-1].close>S[H].data[A[1]-1].open?S[H].style.incrementItemColor:S[H].style.decrementItemColor,onlyRender:!0},!1,!0,!1)},st=function(t){S[t]&&"candle"===S[t].type&&(H=t,bt(),at())};m.addEventListener("mousewheel",function(t){t.preventDefault();var e=Math.round((A[1]-A[0])/8),o=t.deltaY/100*-e,n=[A[0]+o,A[1]];n[0]<0&&(n[0]=0,n[1]-=o),n[1]>w.length&&(n[1]=w.length),n[0]>=n[1]&&(n[0]=n[1]-1),E(n[0],n[1]),gt({x:t.layerX,y:t.layerY})});var ut=!1,ct=null;m.addEventListener("mousedown",function(t){ut=!0,ct=t.clientX}),window.addEventListener("mouseup",function(){ut===!0&&(ut=!1,ct=null)}),window.addEventListener("mousemove",function(t){var e=ct-t.clientX;if(ut===!0){t.preventDefault();var o=ft();if(null!==ct){var n=Math.abs(Math.floor((ct-k.left)/o)-Math.floor((t.clientX-k.left)/o)),r=0>e?-1:1,i=r*n,l=[A[0]+i,A[1]+i];if(l[0]<0||l[1]>w.length)return;E(l[0],l[1]),ct=t.clientX}}}),m.addEventListener("mousemove",function(t){gt({x:t.layerX,y:t.layerY})}),m.addEventListener("mouseout",function(t){pt()});var ft=function(){return K().tWidth/(A[1]-A[0])},ht=void 0,dt=function(t){var e=t.ctx,o=void 0===e?$:e,n=t.x,r=t.y,i=t.index,a=t.realPrice,f=t.focusXBackgroundColor,h=void 0===f?P.focusXBackgroundColor:f,d=t.focusXLabelColor,g=void 0===d?P.focusXLabelColor:d,p=t.focusXAxisColor,v=void 0===p?P.focusXAxisColor:p,y=t.focusYAxisColor,x=void 0===y?P.focusYAxisColor:y,b=t.focusYBackgroundColor,C=void 0===b?P.focusYBackgroundColor:b,S=t.focusYLabelColor,T=void 0===S?P.focusYLabelColor:S,H=t.onlyRender,X=void 0===H?!1:H,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,W=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,B=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!0,R=K(),V=R.tWidth,_=R.tHeight;void 0===a?a=l(r,k.top+_-L.bottom,k.top+L.top,I,Y):r=l(a,I,Y,k.top+_-L.bottom,k.top+L.top);var E=V/(A[1]-A[0]),z=void 0;if(void 0===i?(z=Math.floor((n-k.left)/E),i=A[0]+z):i-=A[0],ht!==i){if(0>i||i>=A[1])return void o.clearRect(-10,-10,m.clientWidth+10,m.clientHeight+10);if(o.save(),B===!0&&o.clearRect(-10,-10,m.clientWidth+10,m.clientHeight+10),o.translate(k.left,0),o.font="12px "+P.fontFamily,F===!0){if(o.textAlign=P.xLabelAlign,o.textBaseline="middle",o.strokeStyle=$.fillStyle=v,P.focusXAxisExtend===!0)o.fillRect(z*E,k.top,E,_);else{var N=z*E+E/2;o.beginPath(),o.moveTo(N,0),o.lineTo(N,k.top+_),o.closePath(),o.stroke()}if(P.xLabelShow!==!1){var O=u(w[i],M),j=$.measureText(O).width,U=5;E>j+2*U&&(U=(E-j)/2,j=E-2*U);var G=z*E,J=void 0,Q=void 0;"top"===P.xLabelAlign?(J=0,Q=k.top):(J=_,Q=k.bottom),"right"===P.yLabelAlign||(G-=j+2*U-E),o.fillStyle=h,o.fillRect(G,J,j+2*U,Q),o.fillStyle=g,o.fillText(O,G+U,J+Q/2)}}if(W===!0&&k.top+_>=r&&k.top<=r){o.textBaseline="middle",o.strokeStyle=x,o.fillStyle=C,o.beginPath(),o.moveTo(0,r),o.lineTo(V,r),o.closePath(),o.stroke();var Z=void 0,tt=void 0,et=20,ot=void 0;"left"===P.yLabelAlign?(Z=-k.left,tt=k.left,ot=-10,o.textAlign="right"):(Z=V,tt=k.right,ot=V+10,o.textAlign="left"),o.fillRect(Z,r-et/2,tt,et),o.fillStyle=T,o.fillText(q(a),ot,r)}if(o.restore(),X!==!0){var nt=D(function(t,e){return"object"===t.data[i]?s(null,t.data[i]):t.data[i]},function(t){return t}),rt=new Date(w[i]);c.onSelect(rt,nt),Ct(i)}}},gt=function(t){return Mt()!==!0?(h[c.$rootConnect].dispatchFocusIndex(t),void dt(t,!1,!0,!1)):(h[v].dispatchFocusIndex(t),void dt(t,!0,!0))},mt=function(){$.clearRect(-10,-10,m.clientWidth+10,m.clientHeight+10)},pt=function(){return Mt()!==!0?void h[c.$rootConnect].dispatchUnfocusIndex():(h[v].dispatchUnfocusIndex(),void mt())},vt={show:!1,forammters:{},titles:{},filters:[]},yt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(t.formatters,vt.formatters),s(t.titles,vt.titles),vt=s(t,vt),bt()},xt=null,bt=function(){return null!==xt&&Ct(xt)},Ct=function(){var t=function(t){var e=t.ctx,o=t.texts,n=t.lineHeight,r=t.minWidth,i=void 0===r?P.tooltipMinWidth:r,l=t.notRender,a=void 0===l?!1:l,s=1,u=0,c=P.tooltipLetterSpace,f=!1,h=i;o.forEach(function(t){var o=void 0;o=Array.isArray(t.text)===!0?e.measureText(t.text.join("")).width+(t.text.length-1)*c:e.measureText(t.text).width,t.width=o,o>h&&(h=o)});for(var d=0;d<o.length;d++){var g=o[d];if(h<u+g.width&&(a!==!0&&e.translate(0,n),u=0,s++),a!==!0)if(e.fillStyle=g.color,Array.isArray(g.text)===!0)for(var m=0,p=0;p<g.text.length;p++)e.fillText(g.text[p],m+p*c,0),m+=e.measureText(g.text[p]).width;else e.fillText(g.text,u,0);u+=g.width+c,f=!0}return s=f===!1?0:s,{lineCount:s,height:s*n,width:h}};return function(e){var o=vt,r=o.show,i=o.filters,l=o.formatters,a=o.titles;if(B.clearRect(-10,-10,m.clientWidth+20,m.clientHeight+20),r===!0){var s=[],u=P.tooltipFontSize,c=1.2*u;B.font=u+"px "+P.fontFamily,B.textBaseline="top";for(var f in S){var h=S[f];if(-1===i.indexOf(f)&&h.show!==!1){var d=n[h.type]({title:a[f]||f,formatter:l&&l[f],data:h.data[e]});null!==d&&s.push({text:d,color:"string"==typeof h.style.itemColor?h.style.itemColor:P.tooltipTextColor})}}B.save();var g=function(e){return t({ctx:B,texts:s,lineHeight:c,notRender:e})},p=P.tooltipYPadding,v=P.tooltipXPadding,y=g(!0),x=y.height+p,b=y.width+v,C=K(),A=C.tWidth,T=C.tHeight;if(B.translate(k.left,k.top),"left"===P.tooltipXAlign?B.translate(P.tooltipXMargin,0):"right"===P.tooltipXAlign&&B.translate(A-b-P.tooltipCandleThick-P.tooltipXMargin,0),"top"===P.tooltipYAlign?B.translate(0,P.tooltipYMargin):"bottom"===P.tooltipYAlign&&B.translate(0,T-x-P.tooltipYMargin),H){var w=S[H],L=w.data,M=w.style;if(L[e]){var I=L[e],Y=I.open,X=I.close;B.fillStyle=X>Y?M.incrementItemColor:M.decrementItemColor,B.fillRect(0,0,P.tooltipCandleThick,x),B.translate(P.tooltipCandleThick,0)}}H||"right"!==P.tooltipXAlign||B.translate(P.tooltipCandleThick,0),B.fillStyle=P.tooltipBackgroundColor,B.fillRect(0,0,b,x),B.translate(v/2,1.2),g(),B.restore(),xt=e}}}(),St=function(){for(var t in e.layerStyle)x[t]=s(y.layerStyle[t],e.layerStyle[t])},At=function(){m.style.backgroundColor=P.backgroundColor},Tt=function(t){y=o[t],P=s(y.globalStyle,P),At(),St();for(var e in S){var n=S[e];V(e,{style:x[n.type]})}J(),Z(),tt()},wt=function(){b.map(function(t){t.width=m.clientWidth,t.height=m.clientHeight}),it()},kt=[],Lt=function(t){if(t instanceof p==!0){if(null!==c.$rootConnect)return void h[c.$rootConnect].connect(t);d(t.$key,"getTimeline",g(v,"getTimeline")),kt.push(t.$key),t.$rootConnect=v,it(),t.render()}},Pt=function(){Mt()===!0?(kt.map(function(t){return h[t].disconnect()}),kt.splice(0,kt.length)):h[v].disconnect(),it()};d(v,"getTimeline",function(){return T}),d(v,"_setViewport",_),d(v,"dispatchSetViewport",function(t,e){c.$connect.length>0&&(_(t,e),kt.map(function(o){h[o]._setViewport(t,e)}))}),d(v,"_focusIndex",dt),d(v,"dispatchFocusIndex",function(t){c.$connect.length>0&&(dt(t),kt.map(function(e){h[e]._focusIndex(t)}))}),d(v,"_unfocusIndex",mt),d(v,"dispatchUnfocusIndex",function(){c.$connect.length>0&&(mt(),kt.map(function(t){h[t]._unfocusIndex()}))}),d(v,"_setTimeline",function(){w.length<A[1]&&(A[1]=w.length),it()}),d(v,"dispatchSetTimeline",function(){c.$connect.length>0&&kt.map(function(t){d(t,"getTimeline",function(){return T}),h[t]._setTimeline()})}),d(v,"connect",function(){return Lt}),d(v,"disconnect",function(){d(v,"getTimeline",function(){return T}),c.$rootConnect=null,it()}),d(v,"minSpan",function(){return P.minSpan}),d(v,"$On",function(t){"getTimeline"===t&&(w=g(v,"getTimeline")())}),this.$key=v,this.$connect=kt,this.$rootConnect=null;var Mt=function(){return null===c.$rootConnect};this.addLayer=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return R.apply(c,e),c},this.setLayer=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return V.apply(c,e),c},this.setViewport=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return E.apply(c,e),c},this.getViewport=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return z.apply(c,e),c},this.setTimeline=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return N.apply(c,e),c},this.setPadding=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return j.apply(c,e),c},this.setStyle=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return U.apply(c,e),c},this.setTheme=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return Tt.apply(c,e),c},this.resize=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return wt.apply(c,e),c},this.setDateFormatter=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return O.apply(c,e),c},this.setTooltip=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return yt.apply(c,e),c},this.connect=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return Lt.apply(c,e),c},this.disconnect=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return Pt.apply(c,e),c},this.setYLabelFormatter=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return G.apply(c,e),c},this.setMainCandle=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return st.apply(c,e),c},this.getViewport=function(){return[A[0],A[1]]},this.showLayers=function(t){for(var e=0;e<t.length;e++){var o=S[t[e]];o&&(o.show=!0),it()}return c},this.hideLayers=function(t){for(var e=0;e<t.length;e++){var o=S[t[e]];o&&(o.show=!1),it()}return c},this.render=function(){return it(),c},this.onSelect=function(){},this.renderTooltip=function(){for(var t=arguments.length,e=Array(t),o=0;t>o;o++)e[o]=arguments[o];return lt.apply(c,e),c},J(),Tt("white")}};return m.themes=o,m.getTheme=function(t){return o[t]},m.addTheme=function(t,e){return o[t]=e},m.calculateMA=function(t,e){for(var o=[],n=[],r=0,i=0,l=e.length;l>i;i++)o[i]=null,n.push(e[i]),r+=e[i],n.length===t&&(o[i]=r/t,r-=n.shift());return o},m.toValue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;if(isNaN(t)===!0)return"N/A";t=cutDemicalPoint(t,e);var o=t.toString().split("."),n=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");if(void 0===o[1])return n;if(o[1].length<e)for(var r=0;r<e-o[1].length;r++)o[1]+="0";return n+"."+o[1]},m}();
